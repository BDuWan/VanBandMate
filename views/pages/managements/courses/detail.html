<div class="dialog-area">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 col-md-3 col-sm-3 col-xs-12">
                <div class="dialog-inner">
                    <div class="contact-hd dialog-hd" style="height: 450px;">
                        <h5 class="tag-a">Course Information</h5>
                        <div class="contact-win">
                            <div class="contact-img">
                                <img src="/assets/images/courses/{{.Course.Image}}" alt="">
                            </div>
                        </div>
                        <div class="contact-ctn">
                            <div class="contact-ad-hd">
                                <!--<h5>Instructor: {{.Course.User.FirstName}} {{.Course.User.LastName}}</h5>-->
                            </div>
                        </div>
                        <div class="contact-ctn">
                            <div class="contact-ad-hd">
                                <h5>Course Name: {{.Course.Name}}</h5>
                            </div>
                            <p>{{.Course.Description}}</p>
                        </div>
                        <div class="contact-ctn">
                            <div class="contact-ad-hd">
                                <h5>Program Name: {{.Course.StudyProgram.Title}}</h5>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-8 col-md-3 col-sm-3 col-xs-12">
                <div class="dialog-inner">
                    <div class="discussion-container">
                        <div class="comment-form">
                            <textarea id="comment-text" placeholder="Add a comment..."></textarea>
                            <button id="submit-comment">Comment</button>
                        </div>
                        <div class="comments-list">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="dialog-inner mg-t-30 mh-250">
                    <div class="data-table-list" style="padding: 0;">

                        <div class="basic-tb-hd row">
                            <div class="col-lg-10 col-sm-12">
                                <h5 class="tag-a">Students</h5>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <div class="dataTables_wrapper">
                                <table id="table-students" class="table table-striped dataTable c-f-dataTable">
                                    <thead>
                                    <tr>
                                        <th class="t-id">STT</th>
                                        <th>First Name</th>
                                        <th>Last Name</th>
                                        <th>Email</th>
                                        <th>Phone Number</th>
                                        <th>Address</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="dialog-inner mg-t-30 mh-250">
                    <div class="data-table-list" style="padding: 0;">

                        <div class="basic-tb-hd row">
                            <div class="col-lg-10 col-sm-12">
                                <h5 class="tag-a">Assignments</h5>
                            </div>
                            <div class="col-lg-2 col-sm-12 t-right">
                                <button class="btn btn-green btn-reco-mg btn-button-mg waves-effect">
                                    <a href="/managements/mng-courses/create/assignment/{{.Course.CourseID}}" class="btn-green">
                                  <span><i class="fas fa-plus"></i>
                                </span> Add Assignment
                                    </a>
                                </button>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <div class="dataTables_wrapper">
                                <table id="table-assignments" class="table table-striped dataTable c-f-dataTable">
                                    <thead>
                                    <tr>
                                        <th class="t-id">STT</th>
                                        <th>Name</th>
                                        <th style="width: 12%;">Start Time</th>
                                        <th style="width: 12%;">End Time</th>
                                        <th>Action</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="dialog-inner mg-t-30 mh-250">
                    <div class="data-table-list" style="padding: 0;">

                        <div class="basic-tb-hd row">
                            <div class="col-lg-10 col-sm-12">
                                <h5 class="tag-a">Lesson</h5>
                            </div>
                            <div class="col-lg-2 col-sm-12 t-right">
                                <button class="btn btn-green btn-reco-mg btn-button-mg waves-effect">
                                    <a href="/managements/mng-courses/create/lesson/{{.Course.CourseID}}" class="btn-green">
                                  <span><i class="fas fa-plus"></i>
                                </span> Add Lesson
                                    </a>

                                </button>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <div class="dataTables_wrapper">
                                <table id="table-lessons" class="table table-striped dataTable c-f-dataTable">
                                    <thead>
                                    <tr>
                                        <th class="t-id">STT</th>
                                        <th>Title</th>
                                        <th style="width: 12%;">Start Time</th>
                                        <th style="width: 12%;">End Time</th>
                                        <th>Description</th>
                                        <th>Link Study</th>
                                        <th>Link Record</th>
                                        <th>Action</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="dialog-inner mg-t-30 mh-250">
                    <div class="data-table-list" style="padding: 0;">

                        <div class="basic-tb-hd row">
                            <div class="col-lg-10 col-sm-12">
                                <h5 class="tag-a">Documents</h5>
                            </div>
                            <div class="col-lg-2 col-sm-12 t-right">
                                <button class="btn btn-green btn-reco-mg btn-button-mg waves-effect">
                                    <a href="/managements/mng-courses/create/document/{{.Course.CourseID}}" class="btn-green">
                                  <span><i class="fas fa-plus"></i>
                                </span> Add Documents
                                    </a>

                                </button>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <div class="dataTables_wrapper">
                                <table id="table-documents" class="table table-striped dataTable c-f-dataTable">
                                    <thead>
                                    <tr>
                                        <th class="t-id">STT</th>
                                        <th>Name</th>
                                        <th>Description</th>
                                        <th style="width: 12%;">Created Time</th>
                                        <th>Action</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>      
    </div>
</div>
<script>
    function fetchComments() {
        let course_id= parseInt({{.Course.CourseID}}, 10);
        $.ajax({
            url: '/managements/mng-courses/api/comments/' + course_id,
            method: 'GET',
            success: function(comments) {
                renderComments(comments);
            },
            error: function(jqXHR, textStatus, errorThrown) {
                let errorMessage = `Error fetching comments: ${textStatus}, ${errorThrown}`;
                if (jqXHR.responseJSON && jqXHR.responseJSON.message) {
                    errorMessage += ` - ${jqXHR.responseJSON.message}`;
                } else if (jqXHR.responseText) {
                    errorMessage += ` - ${jqXHR.responseText}`;
                }
                alert(errorMessage);
                console.error(errorMessage);
            }
        });
    }

    function formatTimeComment(timeString) {
        const t = new Date(timeString);
        const now = new Date();
        const year = now.getFullYear();
        const month = now.getMonth();
        const day = now.getDate();
        const today = new Date(year, month, day, 0, 0, 0, 0);

        if (t >= today) {
            return t.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }
        return t.toLocaleDateString([], { day: '2-digit', month: '2-digit', year: 'numeric' });
    }

    function renderComments(comments) {
        const commentsList = document.querySelector('.comments-list');
        commentsList.innerHTML = '';

        comments.forEach(comment => {
            const subCommentsHtml = comment.sub_comments && comment.sub_comments.length > 0 ? comment.sub_comments.map(subComment => `
                    <div class="comment" data-comment-id="${comment.comment_id}">
                        <div class="comment-header">
                            <img src="/assets/images/courses/new-zealand-3840x2160-mountain-4k-hd-wallpaper-lake-sea-water-sky-899.jpg" alt="" class="avatar">
                            <div class="user-info">
                                <span class="username">${subComment.User.first_name + ' ' + subComment.User.last_name}</span>
                                <span class="comment-time">${formatTimeComment(subComment.created_at)}</span>
                            </div>
                        </div>
                        <div class="comment-body">
                            ${subComment.content}
                        </div>
                        <div class="comment-actions">
                            <button class="reply-button" data-parent-id="${comment.comment_id}">Reply</button>
                        </div>
                    </div>
                `).join('') : '';

            const showMoreButtonHtml = comment.sub_comments && comment.sub_comments.length > 0 ? '<button class="toggle-comment">Show more</button>' : '';

            const commentHtml = `
                    <div class="comment" data-comment-id="${comment.comment_id}">
                        <div class="comment-header">
                            <img src="/assets/images/courses/new-zealand-3840x2160-mountain-4k-hd-wallpaper-lake-sea-water-sky-899.jpg" alt="" class="avatar">
                            <div class="user-info">
                                <span class="username">${comment.User.first_name + ' ' + comment.User.last_name}</span>
                                <span class="comment-time">${formatTimeComment(comment.created_at)}</span>
                            </div>
                        </div>
                        <div class="comment-body">
                            ${comment.content}
                        </div>
                        <div class="comment-actions">
                            <button class="reply-button" data-parent-id="${comment.comment_id}">Reply</button>
                            ${showMoreButtonHtml}
                        </div>
                        <div class="sub-comments">
                            ${subCommentsHtml}
                        </div>
                    </div>
                `;
            commentsList.insertAdjacentHTML('beforeend', commentHtml);
        });
    }


    document.getElementById('submit-comment').addEventListener('click', function() {
        const commentText = document.getElementById('comment-text').value.trim();
        if (commentText !== '') {
            let user_id= parseInt({{.UserLogin.UserID}}, 10);
            let course_id= parseInt({{.Course.CourseID}}, 10);
            const commentData = {
                content: commentText,
                user_id: user_id,
                course_id: course_id,
                is_child_cmt: false,
                parent_cmt_id: 0
            };
            $.ajax({
                url: '/managements/mng-courses/api/comments',
                method: 'POST',
                contentType: "application/json",
                data: JSON.stringify(commentData),

                success: function (response) {
                    if(response === "Success"){
                        swal({
                            title: 'Successfully !',
                            text: 'Create comment successfully',
                            icon: 'success',
                            button: {
                                text: "Close",
                                value: true,
                                visible: true,
                                className: "btn btn-primary"
                            }
                        })
                        // const newComment = document.createElement('div');
                        // newComment.classList.add('comment');
                        // newComment.innerHTML = `
                        //     <div class="comment-header">
                        //         <img src="avatar_url_here" alt="" class="avatar">
                        //         <div class="user-info">
                        //             <span class="username">{{.UserLoginFullname}}</span>
                        //             <span class="comment-time">just now</span>
                        //         </div>
                        //     </div>
                        //     <div class="comment-body">${commentText}</div>
                        //     <div class="comment-actions">
                        //         <button class="reply-button">Reply</button>
                        //         <button class="toggle-comment">Hide</button>
                        //     </div>
                        //     <div class="sub-comments"></div>
                        // `;
                        // document.querySelector('.comments-list').appendChild(newComment);
                        document.getElementById('comment-text').value = '';
                        fetchComments();
                    }else{
                        swal({
                            title: 'Error !',
                            text: response,
                            icon: 'warning',
                            button: {
                                text: "Close",
                                value: true,
                                visible: true,
                                className: "btn btn-danger"
                            }
                        })
                    }

                },
                error: function () {
                    console.log('Error occurred while retrieving options');
                }
            });
        }
    });

    document.addEventListener('click', function(event) {
        // Handle reply button click
        if (event.target.classList.contains('reply-button')) {
            let existingReplyForm = event.target.closest('.comment').querySelector('.reply-form');
            if (!existingReplyForm) {
                let replyForm = document.createElement('div');
                replyForm.className = 'reply-form';
                replyForm.innerHTML = `
                <textarea class="reply-text" placeholder="Type your reply..."></textarea>
                <button class="submit-reply">Submit</button>
                <button class="cancel-reply">Cancel</button>
            `;
                event.target.parentNode.insertBefore(replyForm, event.target.nextSibling);
            }
        }
        // Handle submit reply button click
        if (event.target.classList.contains('submit-reply')) {
            const replyForm = event.target.closest('.reply-form');
            const replyText = replyForm.querySelector('.reply-text').value.trim();
            const commentIdParent = parseInt(replyForm.closest('.comment').getAttribute('data-comment-id'), 10);
            let user_id = parseInt('{{.UserLogin.UserID}}', 10);
            let course_id = parseInt('{{.Course.CourseID}}', 10);

            if (replyText !== '') {
                $.ajax({
                    url: '/managements/mng-courses/api/comments/reply',
                    method: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        content: replyText,
                        user_id: user_id,
                        course_id: course_id,
                        is_child_cmt: true,
                        parent_cmt_id: commentIdParent,
                    }),
                    success: function(response) {
                        if(response === "Success") {
                            swal({
                                title: 'Successfully!',
                                text: 'Create reply comment successfully',
                                icon: 'success',
                                button: {
                                    text: "Close",
                                    value: true,
                                    visible: true,
                                    className: "btn btn-primary"
                                }
                            });
                            fetchComments();
                            //    const newSubComment = document.createElement('div');
                            //    newSubComment.classList.add('sub-comment');
                            //    newSubComment.innerHTML = `
                            //     <div class="comment-header">
                            //         <img src="avatar_url_subcomment_here" alt="" class="avatar">
                            //         <div class="user-info">
                            //             <span class="username">{{.UserLoginFullName}}</span>
                            //             <span class="comment-time">just now</span>
                            //         </div>
                            //     </div>
                            //     <div class="comment-body">${replyText}</div>
                            //     <div class="comment-actions">
                            //         <button class="reply-button">Reply</button>
                            //     </div>
                            // `;
                            //    const parentComment = replyForm.closest('.comment');
                            //    const subCommentsContainer = parentComment.querySelector('.sub-comments');
                            //    subCommentsContainer.appendChild(newSubComment);
                            //    replyForm.remove();
                        } else {
                            swal({
                                title: 'Error!',
                                text: response,
                                icon: 'warning',
                                button: {
                                    text: "Close",
                                    value: true,
                                    visible: true,
                                    className: "btn btn-danger"
                                }
                            });
                        }
                    },
                    error: function(error) {
                        console.error('Error posting reply:', error);
                    }
                });
            }
        }

        // Handle cancel reply button click
        if (event.target.classList.contains('cancel-reply')) {
            const replyForm = event.target.closest('.reply-form');
            replyForm.remove();
        }

        // Handle toggle comment button click
        if (event.target.classList.contains('toggle-comment')) {
            const subCommentsContainer = event.target.closest('.comment').querySelector('.sub-comments');
            if (subCommentsContainer.style.display === 'none' || subCommentsContainer.style.display === '') {
                subCommentsContainer.style.display = 'block';
                event.target.textContent = 'Hide';
            } else {
                subCommentsContainer.style.display = 'none';
                event.target.textContent = 'Show more';
            }
        }
    });
    $(document).ready(function () {
        fetchComments();
        var CourseID = {{.Course.CourseID}};
        $.fn.dataTable.ext.errMode = 'none';
        var table_students = $('#table-students').DataTable({
            "processing": true,
            "serverSide": true,
            ajax: {
                url: '/managements/mng-courses/api/students/'+CourseID,
                type: 'POST',
                "contentType": "application/json",
                "data": function (d) {
                    return JSON.stringify(d);
                }

            },
            columns: [
                {
                    "data": null,
                    "searchable": false,
                    "orderable": false,
                    "render": function (data, type, full, meta) {
                        return table_students.rows().count() > 0 ?
                            meta.row + meta.settings._iDisplayStart + 1 : 0;
                    }
                },
                {data: 'User.first_name'},
                {data: 'User.last_name'},
                {data: 'User.email'},
                {data: 'User.phone_number'},
                {data: 'User.address'},
            ],

            "drawCallback": function (settings) {
                var api = this.api();
                var startIndex = api.context[0]._iDisplayStart;
                api.column(0, {page: 'current'}).nodes().each(function (cell, i) {
                    cell.innerHTML = startIndex + i + 1;
                });
            },
            "ordering": true,
            lengthMenu: [[5, 10], ['5', '10']],
            // language: {
            //     lengthMenu: "{{.Lag.Show}}" + '_MENU_' + "{{.Lag.Index}}",
            //     infoFiltered: "({{.Lag.InTotal}} _MAX_ {{.Lag.Index}})",
            //     info: "{{.Lag.Show}} _START_ {{.Lag.Arrive}} _END_ {{.Lag.BelongTo}} _TOTAL_ {{.Lag.Index}}",
            //     infoEmpty: "{{.Lag.Show}} 0 {{.Lag.Arrive}} 0 {{.Lag.BelongTo}} 0 {{.Lag.Index}}",
            //     search: "{{.Lag.Search}}",
            //     paginate: {
            //         next: '{{.Lag.Next}}',
            //         previous: '{{.Lag.Previous}}'
            //     },
            // }
        });

        var table_documents = $('#table-documents').DataTable({
            "processing": true,
            "serverSide": true,
            ajax: {
                url: '/managements/mng-courses/api/documents/'+CourseID,
                type: 'POST',
                "contentType": "application/json",
                "data": function (d) {
                    return JSON.stringify(d);
                }

            },
            columns: [
                {
                    "data": null,
                    "searchable": false,
                    "orderable": false,
                    "render": function (data, type, full, meta) {
                        return table_documents.rows().count() > 0 ?
                            meta.row + meta.settings._iDisplayStart + 1 : 0;
                    }
                },
                {
                    data: 'name',
                    render:function (data){
                        return lenString(data,90);
                    },
                    createdCell: function(td, cellData) {
                        td.title = cellData;

                    },
                },
                {data: 'description'},
                {
                    data: 'created_at',
                    render:function (data){
                        return formatTime(data);
                    }
                },
                {
                    data: 'document_id',
                    render: function (data, type, full, row) {
                        if (type === 'display') {

                            return `<div class="row" style="margin:0;">
                                          <div class="col-sm-4 t-center">
                                            <a href="/managements/mng-courses/download/document/${data}">
                                              <i class="fas fa-file-download cl-ed" aria-hidden="true" title="Download"></i>
                                            </a>
                                          </div>
                                          <div class="col-sm-4 t-center">
                                            <a href="/managements/mng-courses/document/edit/${data}">
                                              <i class="fas fa-edit cl-ed" aria-hidden="true" title="Edit"></i>
                                            </a>
                                          </div>
                                          <div class="col-sm-4 t-center">
                                            <a>
                                              <i class="fas fa-trash cl-del item-delete" data-delete="${data}" aria-hidden="true" title="Delete"></i>
                                            </a>
                                          </div>
                                        </div>`;


                        }
                        return data;
                    }
                }
            ],

            "drawCallback": function (settings) {
                var api = this.api();
                var startIndex = api.context[0]._iDisplayStart;
                api.column(0, {page: 'current'}).nodes().each(function (cell, i) {
                    cell.innerHTML = startIndex + i + 1;
                });
            },
            "ordering": true,
            lengthMenu: [[5, 10], ['5', '10']],
        });

        var table_lessons = $('#table-lessons').DataTable({
            "processing": true,
            "serverSide": true,
            ajax: {
                url: '/managements/mng-courses/api/lessons/'+CourseID,
                type: 'POST',
                "contentType": "application/json",
                "data": function (d) {
                    return JSON.stringify(d);
                }

            },
            columns: [
                {
                    "data": null,
                    "searchable": false,
                    "orderable": false,
                    "render": function (data, type, full, meta) {
                        return table_lessons.rows().count() > 0 ?
                            meta.row + meta.settings._iDisplayStart + 1 : 0;
                    }
                },
                {
                    data: 'name',
                    render:function (data){
                        return lenString(data,50);
                    },
                    createdCell: function(td, cellData) {
                        td.title = cellData;

                    },
                },
                {
                    data: 'start_time',
                    render:function (data){
                        return formatTime(data);
                    },
                },
                {
                    data: 'end_time',
                    render:function (data){
                        return formatTime(data);
                    },
                },
                {
                    data: 'description',
                    render:function (data){
                        return lenString(data,30);
                    },
                    createdCell: function(td, cellData) {
                        td.title = cellData;

                    },
                },
                {
                    data: 'link_study',
                    render:function (data){
                        return lenString(data,30);
                    },
                    createdCell: function(td, cellData) {
                        td.title = cellData;

                    },
                },
                {
                    data: 'link_record',
                    render:function (data){
                        return lenString(data,30);
                    },
                    createdCell: function(td, cellData) {
                        td.title = cellData;

                    },
                },
                {
                    data: 'lesson_id',
                    render: function (data, type, full, row) {
                        if (type === 'display') {

                            return `<div class="row" style="margin:0;">
                                          <div class="col-sm-6 t-center">
                                            <a href="/managements/mng-courses/lesson/edit/${data}">
                                              <i class="fas fa-edit cl-ed" aria-hidden="true" title="Edit"></i>
                                            </a>
                                          </div>
                                          <div class="col-sm-6 t-center">
                                            <a>
                                              <i class="fas fa-trash cl-del item-delete-lesson" data-delete-lesson="${data}" aria-hidden="true" title="Delete"></i>
                                            </a>
                                          </div>
                                        </div>`;


                        }
                        return data;
                    }
                }
            ],

            "drawCallback": function (settings) {
                var api = this.api();
                var startIndex = api.context[0]._iDisplayStart;
                api.column(0, {page: 'current'}).nodes().each(function (cell, i) {
                    cell.innerHTML = startIndex + i + 1;
                });
            },
            "ordering": true,
            lengthMenu: [[5, 10], ['5', '10']],
        });

        var table_assignments = $('#table-assignments').DataTable({
            "processing": true,
            "serverSide": true,
            ajax: {
                url: '/managements/mng-courses/api/assignments/'+CourseID,
                type: 'POST',
                "contentType": "application/json",
                "data": function (d) {
                    return JSON.stringify(d);
                }

            },
            columns: [
                {
                    "data": null,
                    "searchable": false,
                    "orderable": false,
                    "render": function (data, type, full, meta) {
                        return table_assignments.rows().count() > 0 ?
                            meta.row + meta.settings._iDisplayStart + 1 : 0;
                    }
                },
                {
                    data: 'name',
                    render:function (data){
                        return lenString(data,50);
                    },
                    createdCell: function(td, cellData) {
                        td.title = cellData;

                    },
                },
                {
                    data: 'start_time',
                    render:function (data){
                        return formatTime(data);
                    },
                },
                {
                    data: 'end_time',
                    render:function (data){
                        return formatTime(data);
                    },
                },
                {
                    data: 'assignment_id',
                        render: function (data, type, full, row) {
                    if (type === 'display') {

                        return `<div class="row" style="margin:0;">
                                                  <div class="col-sm-4 t-center">
                                                    <a href="/managements/mng-courses/assignment/${data}">
                                                      <i class="fas fa-info-circle cl-ed" aria-hidden="true" title="Information"></i>
                                                    </a>
                                                  </div>
                                                  <div class="col-sm-4 t-center">
                                                    <a href="/managements/mng-courses/assignment/edit/${data}">
                                                      <i class="fas fa-edit cl-ed" aria-hidden="true" title="Edit"></i>
                                                    </a>
                                                  </div>
                                                  <div class="col-sm-4 t-center">
                                                    <a>
                                                      <i class="fas fa-trash cl-del item-delete-assignment" data-delete-assignment="${data}" aria-hidden="true" title="Delete"></i>
                                                    </a>
                                                  </div>
                                                </div>`;


                    }
                    return data;
                }
                }
            ],

        "drawCallback": function (settings) {
            var api = this.api();
            var startIndex = api.context[0]._iDisplayStart;
            api.column(0, {page: 'current'}).nodes().each(function (cell, i) {
                cell.innerHTML = startIndex + i + 1;
            });
        },
        "ordering": true,
            lengthMenu: [[5, 10], ['5', '10']],
    });

        $('#table-documents tbody').on('click', '.item-delete', function() {
            var DocumentID = $(this).data('delete');
            swal({
                title: 'Confirm Delete ?',
                icon: 'warning',
                buttons: {
                    cancel: {
                        text: "Cancel",
                        value: null,
                        visible: true,
                        className: "btn btn-danger",
                        closeModal: true,
                    },
                    confirm: {
                        text: "OK",
                        value: true,
                        visible: true,
                        className: "btn btn-primary",
                        closeModal: true
                    }
                }
            }).then((result=>{
                if(result){
                    $.ajax({
                        url: '/managements/mng-courses/document/' + DocumentID,
                        type: 'DELETE',
                        success: function (response) {
                            if(response === "Success"){
                                swal({
                                    title: 'Successfully !',
                                    icon: 'success',
                                    button: {
                                        text: "Close",
                                        value: true,
                                        visible: true,
                                        className: "btn btn-primary"
                                    }
                                })
                                table_documents.ajax.reload();
                            }else {
                                swal({
                                    title: 'Error !',
                                    text: response,
                                    icon: 'warning',
                                    button: {
                                        text: "Close",
                                        value: true,
                                        visible: true,
                                        className: "btn btn-danger"
                                    }
                                })
                            }

                        },
                        error: function (xhr, status, error) {
                            console.error("Error deleting row:", status, error);
                        }
                    });
                }

            }))

        });

        $('#table-lessons tbody').on('click', '.item-delete-lesson', function() {
            var LessonID = $(this).data('delete-lesson');
            swal({
                title: 'Confirm Delete ?',
                icon: 'warning',
                buttons: {
                    cancel: {
                        text: "Cancel",
                        value: null,
                        visible: true,
                        className: "btn btn-danger",
                        closeModal: true,
                    },
                    confirm: {
                        text: "OK",
                        value: true,
                        visible: true,
                        className: "btn btn-primary",
                        closeModal: true
                    }
                }
            }).then((result=>{
                if(result){
                    $.ajax({
                        url: '/managements/mng-courses/lesson/' + LessonID,
                        type: 'DELETE',
                        success: function (response) {
                            if(response === "Success"){
                                swal({
                                    title: 'Successfully !',
                                    icon: 'success',
                                    button: {
                                        text: "Close",
                                        value: true,
                                        visible: true,
                                        className: "btn btn-primary"
                                    }
                                })
                                table_lessons.ajax.reload();
                            }else {
                                swal({
                                    title: 'Error !',
                                    text: response,
                                    icon: 'warning',
                                    button: {
                                        text: "Close",
                                        value: true,
                                        visible: true,
                                        className: "btn btn-danger"
                                    }
                                })
                            }

                        },
                        error: function (xhr, status, error) {
                            console.error("Error deleting row:", status, error);
                        }
                    });
                }

            }))

        });

        $('#table-assignments tbody').on('click', '.item-delete-assignment', function() {
            var AssignmentID = $(this).data('delete-assignment');
            swal({
                title: 'Confirm Delete ?',
                icon: 'warning',
                buttons: {
                    cancel: {
                        text: "Cancel",
                        value: null,
                        visible: true,
                        className: "btn btn-danger",
                        closeModal: true,
                    },
                    confirm: {
                        text: "OK",
                        value: true,
                        visible: true,
                        className: "btn btn-primary",
                        closeModal: true
                    }
                }
            }).then((result=>{
                if(result){
                    $.ajax({
                        url: '/managements/mng-courses/assignment/' + AssignmentID,
                        type: 'DELETE',
                        success: function (response) {
                            if(response === "Success"){
                                swal({
                                    title: 'Successfully !',
                                    icon: 'success',
                                    button: {
                                        text: "Close",
                                        value: true,
                                        visible: true,
                                        className: "btn btn-primary"
                                    }
                                })
                                table_assignments.ajax.reload();
                            }else {
                                swal({
                                    title: 'Error !',
                                    text: response,
                                    icon: 'warning',
                                    button: {
                                        text: "Close",
                                        value: true,
                                        visible: true,
                                        className: "btn btn-danger"
                                    }
                                })
                            }

                        },
                        error: function (xhr, status, error) {
                            console.error("Error deleting row:", status, error);
                        }
                    });
                }

            }))

        });

        function formatTime(dateString) {
            const date = new Date(dateString); // Assuming the dateString is in a format recognized by Date.parse()

            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0'); // Months are 0-based
            const year = String(date.getFullYear()); // Get last 2 digits of year

            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            const seconds = String(date.getSeconds()).padStart(2, '0');

            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }

        function lenString(text, length) {
            let count = text.length;
            let stringText = text;
            if (count > length) {
                stringText = "..." + text.substring(count - length + 4, count);
            }
            return stringText
        }

    });
</script>